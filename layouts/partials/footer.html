<div class="fab-actions">
  <button class="d-none d-lg-flex btn btn-primary btn-float btn-float-extended" type="button" data-toggle="modal" data-target="#modal-contact">
    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M4 4h16v12H5.17L4 17.17V4m0-2c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2H4zm2 10h12v2H6v-2zm0-3h12v2H6V9zm0-3h12v2H6V6z"/></svg>
    Contact</button>
  <button class="d-lg-none btn btn-primary btn-float" type="button" data-toggle="modal" data-target="#modal-contact" aria-label="Contact">
    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M4 4h16v12H5.17L4 17.17V4m0-2c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2H4zm2 10h12v2H6v-2zm0-3h12v2H6V9zm0-3h12v2H6V6z"/></svg>
  </button>
</div>

<!-- Contact -->
<div class="modal fade" id="modal-contact" tabindex="-1" role="dialog" aria-labelledby="modal-contact-title"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <img class="d-none d-md-block" src="/images/icons/undraw_Typing.svg" alt="Écrire un commentaire" aria-hidden="true" width="250" height="214" loading="lazy" decoding="async">
        <p class="modal-title" id="modal-contact-title">Contact</p>
      </div>
      <form name="contact" method="post" netlify>
      <!--<script>document.querySelector("form").setAttribute("action", "")</script>-->
        <div class="modal-body">
          Une suggestion, une remarque ou une critique ? Dites-le.
          <div class="form-group mt-4">
            <div class="input-group">
              <input class="form-control" placeholder="Mon adresse e-mail" type="email" name="email" autocomplete="email"
                required oninvalid="setCustomValidity('Merci de renseigner votre e-mail.')">
              <span class="input-group-icon" aria-hidden="true">
                <!--Mail--><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6zm-2 0l-8 4.99L4 6h16zm0 12H4V8l8 5 8-5v10z"/></svg>
              </span>
            </div>
          </div>
          <div class="form-group">
            <div class="input-group">
              <textarea class="form-control" placeholder="Commentaires et remarques" rows="5" name="message" required oninvalid="setCustomValidity('Merci de m\'en dire un peu plus.')"></textarea>
              <span class="input-group-icon" aria-hidden="true">
                <!--Rate review--><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9.5-2H18v-2h-5.5zm3.86-5.87c.2-.2.2-.51 0-.71l-1.77-1.77c-.2-.2-.51-.2-.71 0L6 11.53V14h2.47l5.89-5.87z"/></svg>
              </span>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Annuler</button>
          <button type="submit" class="btn btn-primary">Envoyer</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="{{ .Site.Params.cdn.jquery }}" {{ printf "integrity=%q" .Site.Params.cdn.jquery_hash | safeHTMLAttr }} crossorigin></script>
<script src="{{ .Site.Params.cdn.bs_js }}" {{ printf "integrity=%q" .Site.Params.cdn.bs_js_hash | safeHTMLAttr }} crossorigin></script>
<script src="{{ .Site.Params.cdn.material_js}}" crossorigin defer></script>
<script src="https://instant.page/5.1.0" type="module" crossorigin></script>

{{- with .Params.chart }}
<script src="https://cdn.jsdelivr.net/npm/apexcharts@3.27.3/dist/apexcharts.min.js" integrity="sha256-x4AZmQagtBywXlLkl+w68R39zbcAh9gN22tfqoi2cTQ=" crossorigin defer></script>
<script>
document.addEventListener( 'DOMContentLoaded', event => {
  Apex = {
    colors: ['#4150f5', '#ffa600', '#dc0fc3', '#ff6642', '#ff0581'],
    chart: {
      background: 'transparent',
      fontFamily: 'Roboto, sans-serif',
      foreColor: 'inherit',
      type: 'bar',
      zoom: { enabled: false }
    },
    dataLabels: {
      style: {
        // colors: ['#F44336', '#E91E63', '#9C27B0']
      }
    },
    grid: {
      show: false,
      padding: { right: 16, left: 16}
     },
    markers: { size: 4 },
    plotOptions: {
      bar: { borderRadius: 2, columnWidth: '70%' }
    },
    stroke: {
      show: true,
      width: 2,
      colors: ['transparent']
    },
    title: {
      margin: 24,
      offsetX: 48,
      style: {
        fontSize: '18px',
        fontWeight: 'normal'
      }
    },
    subtitle: {
      margin: 16,
      offsetX: 48,
      style: { 
        color:  'rgba(0,0,0,0.6)',
        fontSize: '14px'
      }
    },
    xaxis: {
      style: { 
        color:  'rgba(0,0,0,0.6)'
      },
      crosshairs: {show: false},
      tooltip: {enabled: false}
    },
    yaxis: {
      forceNiceScale: true,
      labels: {
        style: { colors: 'rgba(0,0,0,0.6)' }
      },
      min: 0
    }
  }
  const chart = new ApexCharts(document.getElementById('chart'), chartOptions)
  chart.render()
  
})
</script>
{{- end -}}

{{- with .Params.flowchart }}
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.2/dist/mermaid.min.js" integrity="sha256-UIQPVkGifpwMvDH5yGgORJ9sSTDq38zz6BGU6dNaKhM=" crossorigin defer></script>
<script>
  // https://mermaid-js.github.io/mermaid/#/Setup?id=fontfamily
  const MermaidConfig = {
    fontFamily: 'Roboto',
    fontSize: '1rem',
    defaultLinkColor: '#4150f5',
    nodeBorder: '#fff',
    nodeTextColor: '#212121',
    // logLevel: 1,
    startOnLoad: true,
    securityLevel: 'loose',
    themeCSS: '.node rect, .node polygon {stroke-width: 0;} .edgePath {opacity: 0.3 !important} .edgePath .path {stroke-width: 2px;}',
    flowchart: {
      curve: 'Basis',
      htmlLabels: true,
      nodeSpacing: 30,
      rankSpacing: 40,
    }, mermaid: {
      callback:function(id) {
        //$('#' + id).css('opacity', '0');
      }
    }
  }

  window.onload = () => {
    mermaid.initialize(MermaidConfig);
  }
</script>
{{- end -}}

{{- with .Params.slider }}
<script src="https://cdn.jsdelivr.net/npm/ion-rangeslider/js/ion.rangeSlider.min.js" crossorigin></script>
<script>
  $('.slider-default').ionRangeSlider()
</script>

{{- end -}}

{{- with .Params.paludisme }}
{{ partial "outils/paludisme" . }}
{{- end -}}

{{- with .Params.paracetamol }}
{{ partial "outils/paracetamol" . }}
{{- end -}}

{{- with .Params.epreuveeffort }}
{{ partial "outils/epreuve-effort" . }}
{{- end -}}

{{- with .Params.datatable }}
  {{ partial "datatable" . }}
{{- end -}}

<script>
  // Search menu
  let params = {
    json_src       : '/index.json', // for multiple sources: comma separated list of JSONarrays
    minlength      : 3,
    defaultsearch  : 'AND',
    sort_date      : 'DESC',
    autocomplete   : 1, // 0: form needs a submit button
    section_search : 0, // 1: needs checkboxes with name="section[]"
    badwords       : 'et,le,la,ceci,cela', //ignore this words
    json_wait      : '<a class="dropdown-item"><div class="progress-circular"><div class="progress-circular-wrapper"><div class="progress-circular-inner"><div class="progress-circular-left"><div class="progress-circular-spinner"></div></div><div class="progress-circular-gap"></div><div class="progress-circular-right"><div class="progress-circular-spinner"></div></div></div></div></div></a>',
    json_ready     : '<span class="dropdown-item-text text-black-secondary">Entrer 3 lettres...</span>',
    extern_icon    : ' (external link)', // marker for external links (optional)
    err_badstring  : '<span class="dropdown-item-text text-black-secondary">Entrer 3 lettres...</span>',
    err_noresult   : '<span class="dropdown-item-text text-black-secondary">Aucun résultat</span>',
    err_norequest  : '<span class="dropdown-item-text text-black-secondary">Recherche de texte non implémentée.</span>',
    err_filefailed : '<span class="dropdown-item-text text-danger">Moteur de recherche introuvable.</span>',
    res_one_item   : '', // [CNT] RESULT
    res_more_items : '', // [CNT] RESULTS
    res_out_top    : '', // <ul>
    res_out_bottom : '', // </ul>
    res_item_tpl   : '<a class="dropdown-item" href="[URL]" title="[TITLECAPT]">[TITLE]</a>',
    add_searchlink : ''
  }
  
  // Translation of section name (optional)
  let section_trans = {
    // "post" : "Blog",
    // "other-section" : "Other Section"
  }
  
  let searchfield_weight = {
    "title"   : 5,
    "tags"    : 5,
    "content" : 1
  }
</script>

{{ $searchjs := resources.Get "js/search.js" | minify }}
<script src="{{ $searchjs.Permalink }}" defer></script>
<script><!-- Custom scripts -->
  {{ if eq .Section "recommandations" }}

    // Don't follow external sources
    document.addEventListener( 'DOMContentLoaded', event => { // When DOM is ready
      let externalLinks = document.querySelectorAll('a[href^="http"]:not([href*="netlify.app"])')
      externalLinks.forEach((elem) => {
        elem.setAttribute('target', '_blank')
        elem.setAttribute('rel', 'nofollow noopener')
      })
      let internalLinks = document.querySelectorAll('.recommandation__content a[href^="/recommandations/"]:not([href*="#"])')
      internalLinks.forEach((elem) => {
        elem.setAttribute('target', '_blank')
      })
    })
  {{ end }}

  $(function() {
    $('.breadcrumb-item:last-of-type').addClass('active').find('a').each(function() {
      let linkText = $(this).text();
      $(this).before(linkText);
      $(this).remove();
    });

    $('[data-toggle="tooltip"]').tooltip({
      container: 'body',
      html: true,
      placement: 'bottom'
    });
    if (matchMedia('(pointer:fine)').matches) {
      // Device has a mouse
      $('[rel="tooltip"]').tooltip({trigger: 'hover', placement: 'bottom'});
    }
  });
</script>